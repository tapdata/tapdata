## **Connection configuration help**

### **1. MYSQL Installation Instructions**

Please follow the instructions below to ensure that the MySQL database is successfully added and used in Tapdata.

### **2. Supported version**
MySQL 5.0, 5.1, 5.5, 5.6, 5.7, 8.x

### **3. Prerequisites (as source)**
#### **3.1 Open Binlog**
- MySQL binlog must be turned on for Tapdata to complete synchronization normally.
- Cascaded delete (CASCADE DELETE), this type of delete generated by the database will not be recorded in the binlog, so it is not supported.
  Modify `$MYSQL_HOME/mysql.cnf`, for example:
```
server_id = 223344
log_bin = mysql-bin
expire_logs_days = 1
binlog_format = row
binlog_row_image  = full
```
Configuration explanation:<br>
server-id: Must be unique for each server and replication client in MySQL<br>
binlog_format: Must be set to row or ROW<br>
binlog_row_image: must be set to full<br>
expire_logs_days: The number of days to keep the binary log file, it will be automatically deleted when it expires<br>
log_bin: the base name of the binlog sequence file<br>

#### **3.2 Restart MySQL**

```
/etc/inint.d/mysqld restart
```
To verify that binlog is enabled, execute the following command in the mysql shell
```
show variables like'binlog_format';
```
In the output result, the format value should be "ROW"

Verify that the value of the binlog_row_image parameter is full:
```
show variables like'binlog_row_image';
```
In the output result, the binlog_row_image value should be "FULL"

#### **3.3 Create MySQL Account**
After Mysql8, the password encryption method is different, please pay attention to use the corresponding version to set the password, otherwise it will cause the incremental synchronization to fail
##### **3.3.1 5.x version**
```
create user'username'@'localhost' identified by'password';
```
##### **3.3.2 8.x version**
```
// Create user
create user'username'@'localhost' identified with mysql_native_password by'password';
// change Password
alter user'username'@'localhost' identified with mysql_native_password by'password';

```

#### **3.4 Authorize tapdata account**
Assign select permission to a database
```
GRANT SELECT, SHOW VIEW, CREATE ROUTINE, LOCK TABLES ON <DATABASE_NAME>.<TABLE_NAME> TO'tapdata' IDENTIFIED BY'password';
```
For global permissions
```
GRANT RELOAD, SHOW DATABASES, REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO'tapdata' IDENTIFIED BY'password';
```
#### **3.5 Restriction Description**
```
When synchronizing from MySQL to other heterogeneous databases, if the source MySQL has a table cascade setting, data updates and deletions triggered by the cascade will not be transferred to the target. If you need to build cascading processing capabilities on the target side, you can use triggers and other means to achieve this type of data synchronization depending on the target situation.
```
### **4. Prerequisites (as a goal)**
Grant all permissions to a database
```
GRANT ALL PRIVILEGES ON <DATABASE_NAME>.<TABLE_NAME> TO'tapdata' IDENTIFIED BY'password';
```
For global permissions
```
GRANT PROCESS ON *.* TO'tapdata' IDENTIFIED BY'password';
```
### **5. Common mistakes**

Unknown error 1044
If the permission has been granted, but the test connection still cannot be passed through tapdata, you can check and fix it through the following steps
```
SELECT host,user,Grant_priv,Super_priv FROM mysql.user where user='username';
//Check whether the value of the Grant_priv field is Y
//If not, execute the following command
UPDATE mysql.user SET Grant_priv='Y' WHERE user='username';
FLUSH PRIVILEGES;
```